<!DOCTYPE html>
<html>
<head>
<title>Hideout - Private Chat</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box;margin:0;padding:0}

body{
    font-family:Segoe UI,Tahoma;
    background:#0f0f23;
    color:#fff;
    max-width:900px;
    margin:auto;
    padding:20px;
}

.container{
    background:#141428;
    border-radius:14px;
    padding:25px;
    margin-top:20px;
    border:1px solid rgba(108,140,255,.3);
}

h1{
    text-align:center;
    color:#6c8cff;
    margin-bottom:20px;
}

h2{color:#8da1ff;margin-bottom:15px}

input,button{
    width:100%;
    padding:14px;
    margin:10px 0;
    border-radius:8px;
    font-size:16px;
}

input{
    background:#1e1e3a;
    border:1px solid #6c8cff;
    color:#ffffff;
    caret-color:#6c8cff;
}

input::placeholder{color:#9aa0ff}

button{
    background:#6c8cff;
    border:none;
    color:white;
    cursor:pointer;
    font-weight:bold;
}

button:hover{opacity:.9}

#messages{
    height:420px;
    overflow-y:auto;
    background:#1b1b35;
    padding:15px;
    border-radius:10px;
    margin-bottom:15px;
}

.message{
    padding:10px 14px;
    margin-bottom:10px;
    border-radius:14px;
    max-width:80%;
    font-size:15px;
}

.my-message{
    background:#2d4b9e;
    margin-left:auto;
    text-align:right;
}

.their-message{
    background:#2a2a4a;
}

.timestamp{
    font-size:11px;
    opacity:.7;
    margin-top:5px;
}

.message-input-container{
    display:flex;
    gap:8px;
}

#message-input{flex:1}

.emoji-panel{
    display:none;
    margin-top:8px;
}

.emoji-panel span{
    font-size:22px;
    margin-right:8px;
    cursor:pointer;
}

.typing-indicator{
    font-size:14px;
    color:#4dff88;
    margin-bottom:8px;
    display:none;
}
</style>
</head>

<body>

<h1>üï∂Ô∏è HIDEOUT</h1>

<div id="auth-screen" class="container">
<h2>Login</h2>
<input id="login-email" type="email" placeholder="Email">
<input id="login-password" type="password" placeholder="Password">
<button onclick="login()">Enter</button>
</div>

<div id="chat-screen" class="container" style="display:none">
<h2>Secure Chat</h2>

<div class="typing-indicator" id="typing-indicator"></div>

<div id="messages"></div>

<div class="message-input-container">
<input id="message-input" placeholder="Type here..." oninput="updateTyping()" onkeypress="enterSend(event)">
<button onclick="sendMessage()">Send</button>
<button onclick="toggleEmoji()">üòä</button>
</div>

<div class="emoji-panel" id="emoji-panel">
<span onclick="addEmoji('üòä')">üòä</span>
<span onclick="addEmoji('üòÇ')">üòÇ</span>
<span onclick="addEmoji('üëç')">üëç</span>
<span onclick="addEmoji('üî•')">üî•</span>
<span onclick="addEmoji('üòé')">üòé</span>
</div>

</div>

<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig={
apiKey:"AIzaSyC3z-0TFNvgAwGIxis--XAzPXjP30DeCe8",
authDomain:"maryum-f169b.firebaseapp.com",
databaseURL:"https://maryum-f169b-default-rtdb.asia-southeast1.firebasedatabase.app",
projectId:"maryum-f169b"
};

firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.database();
let user=null;

auth.onAuthStateChanged(u=>{
if(u){user=u;showChat();loadMessages()}
});

function login(){
auth.signInWithEmailAndPassword(
login-email.value,
login-password.value
);
}

function showChat(){
auth-screen.style.display="none";
chat-screen.style.display="block";
message-input.focus();
}

function sendMessage(){
let text=message-input.value.trim();
if(!text)return;
db.ref("messages").push({
text,
uid:user.uid,
time:Date.now()
});
message-input.value="";
db.ref("typing/"+user.uid).remove();
}

function enterSend(e){
if(e.key==="Enter")sendMessage();
}

function loadMessages(){
db.ref("messages").limitToLast(100).on("child_added",snap=>{
let m=snap.val();
let div=document.createElement("div");
div.className="message "+(m.uid===user.uid?"my-message":"their-message");
div.innerHTML=m.text+"<div class='timestamp'>"+new Date(m.time).toLocaleTimeString()+"</div>";
messages.appendChild(div);
messages.scrollTop=messages.scrollHeight;
});
}

function updateTyping(){
db.ref("typing/"+user.uid).set(true);
setTimeout(()=>db.ref("typing/"+user.uid).remove(),1500);
}

db.ref("typing").on("value",snap=>{
typing-indicator.style.display=snap.exists()?"block":"none";
typing-indicator.textContent="Someone is typing...";
});

function toggleEmoji(){
emoji-panel.style.display=
emoji-panel.style.display==="block"?"none":"block";
}

function addEmoji(e){
message-input.value+=e+" ";
message-input.focus();
}
</script>

</body>
</html>
